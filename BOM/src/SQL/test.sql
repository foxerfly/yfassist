
	 
declare 		@PH CHAR(20),   --配置品号
	@PZH CHAR(15),  --配置编号
	@SJPH CHAR(20),  --上阶品号
	@BJCJ char(60),    --本阶层级
	@BJPH CHAR(20)   --本阶品号 --本阶层级
	
set @BJCJ='000000'
SET @PH='A0301-101003-06001'
SET @PZH='001'
SET @BJPH='B0301-101003-060'

DELETE  FROM COPTR WHERE TR001=@PH AND TR002=@PZH  AND TR003 like rtrim(@BJCJ)+'%'  AND TR009<>@BJPH
DELETE  FROM COPTV WHERE TV001=@PH AND TV002=@PZH  AND  TV003 like rtrim(@BJCJ)+'%'  AND TV003<>@BJCJ

SELECT * FROM COPTV WHERE TV001='A0301-101003-06001' AND TV002='001' AND TV003 LIKE '000000%' 

SELECT  TR003,TR004,TR009 FROM COPTR WHERE TR001='A0301-101003-06001' AND TR002='001' AND TR003 LIKE '000000%'

exec me_procRetrieveStandBom 'A0301-101003-06001','001','','000000','B0301-101003-060'



	 
declare 		@PH CHAR(20),   --配置品号
	@PZH CHAR(15),  --配置编号
	@SJPH CHAR(20),  --上阶品号
	@BJCJ char(60),    --本阶层级
	@BJPH CHAR(20)   --本阶品号 --本阶层级
	
set @BJCJ='000000'
SET @PH='A0301-101003-06001'
SET @PZH='001'
SET @BJPH='B0301-101003-060'

DELETE  FROM COPTR WHERE TR001=@PH AND TR002=@PZH  AND TR003 like rtrim(@BJCJ)+'%'  AND TR009<>@BJPH
DELETE  FROM COPTV WHERE TV001=@PH AND TV002=@PZH  AND  TV003 like rtrim(@BJCJ)+'%'  AND TV003<>@BJCJ

SELECT * FROM COPTV WHERE TV001='A0301-101003-06001' AND TV002='001' AND TV003 LIKE '000000%' 

SELECT  TR003,TR004,TR009 FROM COPTR WHERE TR001='A0301-101003-06001' AND TR002='001' AND TR003 LIKE '000000%'

exec me_procRetrieveStandBom 'A0301-101003-06001','001','','000000','B0301-101003-060'

exec me_procRetrieveStandBom 'A0301-101003-06001','001','','000','A0301-101003-06001'

SELECT * FROM COPTV WHERE TV001='A0301-101003-06001' AND TV002='001' 

SELECT  * FROM COPTR WHERE TR001='A0301-101003-06001' AND TR002='001' and TR003='000'

SELECT  TR003,TR004,TR009 FROM COPTR WHERE TR001='A0301-101003-06001' AND TR002='001' 

delete from   COPTR WHERE TR001='A0301-101003-06001' AND TR002='001' 

delete from   COPTV WHERE TV001='A0301-101003-06001' AND TV002='001' 

